---
title: 2021-05-27_note
date: 2022-11-13 23:10:11
permalink: /pages/b80c73/
categories:
  - 每日随笔
  - 2021-05
tags:
  - 
---
**mood:** :smile:  																		**date: 2021-05-27**  
## 今日计划  
------
- [ ] 节假日订单发票 查询发票信息 调nc接口过慢（测试环境），正式环境正常

- [x] 团购商品 查询 未推送nc问题（正在协商）

  存在发票把商品推完了，订单没得商品推，所以订单显示未推送
## 明日计划  
------
- [ ]  
## 随写 
------

```
// 添加用户名
entOrderNc.setUserName(userEntity.getUsername());
// 添加用户id
entOrderNc.setUserId(userEntity.getUserId());
// 添加推送时间
entOrderNc.setPushTime(new Date());


  // 添加用户名
  entOrderNc.setUserName(userEntity.getNameLogin());
  // 添加用户id
  entOrderNc.setUserId(userEntity.getId());
  // 添加推送时间
  entOrderNc.setPushTime(new Date());
```

```
// 判断user是否为空 为空则判断是系统用户
if (null == userEntity) {
    log.error("无用户信息，自动判定为系统用户");
    userEntity = new SysUserEntity();
    userEntity.setUserId(-1L);
    userEntity.setUsername("系统");
}


 // 判断user是否为空 为空则判断是系统用户
 if (null == userEntity) {
     log.error("无用户信息，自动判定为系统用户");
     userEntity = new EntUserEntity();
     userEntity.setId(-1L);
     userEntity.setNameLogin("系统");
 }
```

```
/**
 * 推送时间
 */
private Date pushTime;

/**
 * 用户id
 */
private Long userId;

/**
 * 用户名称
 */
private String userName;

/**
 * 发票id
 */
private Long invoiceId;
```



```
<insert id="insert" parameterType="com.daoism.biz.entity.gift.OrderNc" >
  insert into tb_consume_order_nc (orderBillId, resultType, createTime, 
    updateTime, requestParam, resultReason,pushTime,userId,userName
    )
  values (#{orderBillId,jdbcType=VARCHAR}, #{resultType,jdbcType=VARCHAR}, #{createTime,jdbcType=TIMESTAMP},
    #{updateTime,jdbcType=TIMESTAMP}, #{requestParam,jdbcType=LONGVARCHAR}, #{resultReason,jdbcType=LONGVARCHAR}
    #{pushTime,jdbcType=TIMESTAMP}, #{userId}, #{userName}
    )
</insert>


  <insert id="batchAddNc" parameterType="com.daoism.biz.entity.gift.OrderNc">
    insert into tb_consume_order_nc
    (
    orderBillId,
    `requestParam`,
    `resultType`,
    `resultReason`,
    `createTime`,
    `extend`,
    `pushTime`,
    `userId` ,
    `userName`
    )
    values
    <foreach collection="list" item="item" index="index" separator=",">
      (#{item.orderBillId},
      #{item.requestParam},
      #{item.resultType},
      #{item.resultReason},
      #{item.createTime},
      #{item.extend},
      #{item.pushTime},
      #{item.userId},
      #{item.userName}
      )
    </foreach>
  </insert>
```



![image-20210527211344976](D:\project\vscode\blog\blogs\每日随笔\2021-05-27_note.assets\image-20210527211344976.png)

