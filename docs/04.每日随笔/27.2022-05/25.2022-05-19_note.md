---
title: 2022-05-19_note
date: 2022-11-13 23:10:11
permalink: /pages/d81c88/
categories:
  - 每日随笔
  - 2022-05
tags:
  - 
---
**mood:** :smile:  									**date: 2022-05-19**  
## 今日计划  
------
- [ ]  
- [ ]  15个单词
## 明日计划  
------
- [ ]  
## 随写 
------

39.性能计数器优化

主要是对 聚合计算数据类进行优化，和输出类优化

聚合计算数据类优化点：

1. 之前的计算平均值，最大值...都是在一个方法中，现在拆开成一个一个方法，方便以后扩展，代码也更清晰

输出类优化：

新增输出类，以前是由reporter类组合收集数据，统计数据，展示数据代码，现在将计算出来的数据交给输出类，做他们自定义输出的事情

longAdder

将自身的值分为多个cell,cell的总值加起来才是`longAdder`



＠sun.misc.Contended

给指定变量进行字节填充，可以避免指定变量与其他变量共享缓存行

围绕以下问题看代码

1. LongAdder 的结构是怎样的？

2. 当前线程应该访问 Cell 数组里面的哪一个 Cell 元素？

3.  如何初始化 Cell 数组？
4. Cell 数组如何扩容？
5. 线程访问分配的 Ce ll 元素有冲突后如何处理？
6. 如何保证线程操作被分配的 Cell 元素的原子性？



