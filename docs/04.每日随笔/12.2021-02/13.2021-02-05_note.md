---
title: 2021-02-05_note
date: 2022-11-13 23:10:11
permalink: /pages/ee9135/
categories:
  - 每日随笔
  - 2021-02
tags:
  - 
---
**mood:** :smile:  																		**date: 2021-02-05**  
## 今日计划  
------
- [x]  决策地图接口 修改
- [x]  定时任务 测试
- [x]  企业下 各个排口的排放总量
## 明日计划

------
- [ ]  
## 随写 
------



1. 将node build 生成的 静态文件 放在 docker里



ci/cd 环境 设置环境变量

1. 引用预设的变量

   ```yml
   GitLab CI/CD has a default set of predefined variables that you can use without any additional specification. You can call issue numbers, user names, branch names, pipeline and commit IDs, and much more.
   
   GitLab CI/CD 有一组默认的预定义变量，不需要任何额外的规范即可使用。您可以调用问题编号、用户名、分支名称、管道和提交 id 等等。
   
   Predefined environment variables are provided by GitLab for the local environment of the runner.
   
   GitLab 为运行程序的本地环境提供了预定义的环境变量。
   
   GitLab reads the .gitlab-ci.yml file and sends the information to the runner, where the variables are exposed. The runner then runs the script commands.
   
   阅读了。Gitlab-ci.然后将信息发送给运行者，在那里变量被暴露出来。然后运行程序运行脚本命令。
   
   Use predefined environment variables 使用预定义的环境变量
   ```

   在.gitlab-ci. yml 文件中，从脚本中调用变量，确保使用正确的语法（CI_JOB_STAGE 为预设的变量）。

   ```yml
   test_variable:
     stage: test
     script:
       - echo $CI_JOB_STAGE
   ```

   

2. 使用自定义变量

 Create a custom variable in 中创建自定义变量`.gitlab-ci.yml`

To create a custom `env_var` variable in the [`.gitlab-ci.yml`](https://docs.gitlab.com/ce/ci/yaml/README.html#variables) file, define the variable/value pair under `variables`:

要在. gitlab-ci. yml 文件中创建自定义 env _ var 变量，请在 variables 下定义变量/值对:

```
variables:
  TEST: "HELLO WORLD"
```

You can then call its value in your script:

然后你可以在脚本中调用它的值:

```
script:
  - echo "$TEST"
```

3. 在gitlab 后台 设置环境变量

![image-20210205145642121](https://gitee.com/zxqzhuzhu/imgs/raw/master/image-20210205145642121.png)

在用户界面中，你可以添加或更新自定义环境变量:

1. Go to your project’s 去你的项目**Settings > CI/CD 设置 > CI/CD** and expand the 并扩大**Variables 变量** section. 部分

2. Click the **Add Variable** button. In the **Add variable** modal, fill in the details:

   点击添加变量按钮，在添加变量模式中，填写详细信息:

   - **Key 钥匙**: Must be one line, with no spaces, using only letters, numbers, or : 必须是一行，没有空格，只使用字母、数字或`_`.
   - **Value 价值**: No limitations. : 没有限制
   - **Type 类型**: `File` or 或`Variable`.
   - **Environment scope 环境范围**: `All`, or specific environments. ，或特定环境
   - **Protect variable 保护变量** (Optional): If selected, the variable is only available in pipelines that run on protected branches or tags. (可选) : 如果选中，该变量只能在运行在受保护分支或标记上的管道中使用
   - **Mask variable 掩码变量** (Optional): If selected, the variable’s (可选) : 如果选择，变量的**Value 价值** is masked in job logs. The variable fails to save if the value does not meet the 变量在作业日志中被屏蔽。如果值不满足[masking requirements 掩蔽要求](https://docs.gitlab.com/ce/ci/variables/README.html#masked-variable-requirements).

After a variable is created, you can update any of the details by clicking the **Edit** button.

创建变量后，可以通过单击 Edit 按钮更新任何细节。

After you set a variable, call it from the `.gitlab-ci.yml` file:

设置一个变量之后，从. gitlab-ci. yml 文件中调用它:

```
test_variable:
  stage: test
  script:
    - echo $CI_JOB_STAGE  # calls a predefined variable
    - echo $TEST          # calls a custom variable of type `env_var`
    - echo $GREETING      # calls a custom variable of type `file` that contains the path to the temp file
    - cat $GREETING 
```

4. 文件类型的自定义环境变量

