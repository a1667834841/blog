---
title: 类加载器
date: 2021-10-08 19:46:04
permalink: /pages/84b402/
categories:
  - 笔记
  - java
  - jvm
tags:
  - 
---
![image-20210329222126460](https://gitee.com/zxqzhuzhu/imgs/raw/master/image-20210329222126460.png)

<img src="https://gitee.com/zxqzhuzhu/imgs/raw/master/image-20210329222725748.png" alt="image-20210329222725748"  />

![image-20210404164313559](https://gitee.com/zxqzhuzhu/imgs/raw/master/image-20210404164313559.png)

# 双亲委派机制 安全问题

如何命名了Java的核心类，比如java.lang.String

如果没有双亲委派机制，那就直接使用自定义的加载器加载类，会造成安全问题

在双亲委派机制的作用下，类加载器会不断地向父级加载器传递请求，然后再有顶级加载器bootrap往下分配或自己加载





# 自定义类加载器

继承ClassLoader 重写findCLass方法

需要使用defindClass 把字节码转化为Class



# 类加载过程

加载（loading）：ClassLoader将class文件读取为字节码文件，然后再根据defindClass方法在java堆中实例化class对象

连接（linking）：

  1. 验证：验证.class文件的字节流中包含的信息使符合当前虚拟机的要求的，并不会危害虚拟机自身的安全

     验证步骤：文件格式验证，元数据验证，字节码验证，符号引用验证

  2. 准备：静态变量赋默认值（例如，static int val = 123;不是将val赋值为123，而是0）

  3. 解析: 是Java虚拟机将常量池内的符号引用替换为直接引用的过程

初始化（initializing）: 调用初始化代码<cinit> ,给静态变量赋初始值



# 创建对象过程

![image-20210405000536565](D:\project\vscode\vuepress-theme-reco-demo\my-blog\blogs\笔记\java\jvm\类加载器.assets\image-20210405000536565.png)

比如 new了一个对象，它含有不是静态的成员变量，加载过程是;

1. class loading
2. class linking
3. class initializing
4. 先去内存申请一块内存空间
5. 成员变量赋默认值
6. 调用构造方法
7. 成员变量才会被赋初始值



# 数据类型的默认值介绍

![image-20210404201423487](D:\project\vscode\vuepress-theme-reco-demo\my-blog\blogs\笔记\java\jvm\类加载器.assets\image-20210404201423487.png)

```
字节码:
其实更类似汇编语言的造型，当然字节码并不是汇编也不是二进制代码，这个格式是只有jvm才能解释执行的。
```

